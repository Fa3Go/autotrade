# Capital API Python 整合系統 V5

這是一個基於群益 Capital API 的 Python 整合交易系統，提供登入認證和即時報價功能。

## 功能特色

### 已實現功能
- **登入認證系統**: 支援群益 API 登入，包含環境選擇(測試/正式)
- **即時報價系統**: 提供股票即時報價、Tick報價、最佳五檔報價
- **帳號管理**: 自動取得和顯示交易帳號資訊
- **模組化設計**: 分離登入、報價功能，方便維護和擴展

### 待開發功能
- 下單交易功能
- 投資組合管理
- 歷史資料查詢
- 技術指標計算

## 檔案結構

```
PythonIntegratedV5/
├── main.py              # 主程式，提供整合介面
├── login_module.py      # 登入模組
├── quote_module.py      # 報價模組
├── Config.py           # 設定檔
├── SKCOM.dll           # 群益 API COM 元件
└── README.md           # 說明文件
```

## 系統需求

- Python 3.6+
- Windows 作業系統
- 已安裝群益 API 相關元件
- 必要的 Python 套件:
  - tkinter (GUI介面)
  - comtypes (COM元件呼叫)

## 安裝與設定

1. **確保已安裝 Python 套件**:
   ```bash
   pip install comtypes
   ```

2. **確認 SKCOM.dll 位置**:
   - 確保 `SKCOM.dll` 檔案與程式檔案在同一資料夾中

3. **執行程式**:
   ```bash
   python main.py
   ```

## 使用說明

### 1. 登入系統
- 輸入群益帳號和密碼
- 選擇連線環境 (建議先使用測試環境)
- 點擊「登入」按鈕
- 等待登入完成並取得交易帳號

### 2. 使用即時報價
- 登入成功後，點擊「開啟即時報價」
- 在報價視窗中點擊「連線報價」
- 輸入股票代碼 (例如: 2330,0050)
- 選擇報價類型並點擊「訂閱股票」
- 即可看到即時報價資訊

### 3. 查詢交易帳號
- 登入後點擊「查詢交易帳號」查看可用帳號

## 重要注意事項

⚠️ **安全提醒**:
- 首次使用請先在測試環境測試
- 請勿在程式中硬編碼帳號密碼
- 建議使用時關閉其他不必要的網路連線
- 程式運行時會產生 LOG 檔案，請定期清理

⚠️ **API 限制**:
- 報價連線有數量限制
- 避免頻繁重複訂閱相同股票
- 請遵守群益 API 使用規範

## 程式架構說明

### LoginManager 類別
- 處理登入認證
- 管理連線狀態
- 取得交易帳號

### QuoteManager 類別
- 處理報價連線
- 管理股票訂閱
- 處理即時報價事件

### 事件處理機制
- 使用 COM 事件處理器接收 API 回調
- 透過 tkinter.after() 更新 GUI 介面
- 確保執行緒安全

## 除錯資訊

如遇問題，請檢查:
1. SKCOM.dll 是否正確載入
2. 網路連線是否正常
3. 帳號密碼是否正確
4. 是否選擇正確的連線環境

## 開發者資訊

此程式基於群益 Capital API 開發，僅供學習和測試使用。
使用前請詳閱群益證券相關使用條款。

---

**版本**: V5
**更新日期**: 2024年
**開發環境**: Python 3.x + Capital API 2.13.55