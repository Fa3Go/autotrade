# 群益證券API整合測試工具 v2.13.55

## 📖 專案概述

這是一個將群益證券API所有功能整合到單一介面的Python測試工具，包含登入管理、股票交易、期貨交易、選擇權交易、市場報價等完整功能。

## ✨ 主要特色

- 🎯 **單一介面整合**: 將分散的V2模組功能整合到一個GUI界面
- 🔐 **完整登入管理**: 支援一般登入、AP身分認證、雙因子驗證
- 📈 **多元交易支援**: 股票、期貨、選擇權完整交易功能
- 💹 **即時報價**: 市場資料訂閱、K線查詢功能
- 🔔 **即時訊息**: 完整的事件回報和訊息顯示
- 🎨 **友善介面**: 分頁式設計，操作直觀

## 🚀 快速開始

### 系統需求

- Windows 作業系統
- Python 3.6 或更高版本
- 已安裝群益證券COM元件 (SKCOM.dll)

### 安裝COM元件

1. 進入 `元件/` 目錄
2. 根據系統位元數執行：
   - 64位元系統: `元件/x64/install.bat`
   - 32位元系統: `元件/x86/install.bat`

### 執行程式

```bash
python CapitalIntegratedTester.py
```

## 📋 功能說明

### 🔐 登入管理頁面

#### 連線設定
- **連線環境**: 正式環境、測試環境、SGX環境選擇
- **帳號登入**: UserID、Password輸入
- **AP身分認證**: 支援AP/APH身分及雙因子驗證

#### 登入後管理
- **使用者選擇**: 登入後選擇交易帳號
- **連線管理**: Proxy連線、斷線、重連功能
- **報價連線**: 一鍵連接報價伺服器

#### 系統工具
- 變更LOG路徑
- 查詢同意書狀態
- 檢視最後LOG記錄
- 下單物件初始化

### 📈 股票交易頁面

#### 下單功能
- **基本資訊**: 股票代號、買賣別、數量、價格
- **交易設定**: 市場別(上市上櫃/興櫃)、交易時段、現券別
- **委託條件**: ROD/IOC/FOK、市價/限價選擇
- **下單方式**: 同步委託、非同步委託

#### 查詢功能
- **委託回報**: 支援多種格式查詢(全部/有效/已成等)
- **成交回報**: 完整成交資訊查詢

### 📊 期貨交易頁面

#### 下單功能
- **期貨資訊**: 期貨代號、買賣別、口數、價格
- **交易設定**: 當沖選擇、新平倉設定
- **委託方式**: 同步/非同步下單

#### 期貨查詢
- **未平倉查詢**: 查詢期貨未平倉部位
- **權益數查詢**: 查詢期貨帳戶權益

### 🎯 選擇權交易頁面

#### 交易功能
- 選擇權代號輸入
- 買賣別選擇
- 口數、價格設定
- 委託送出功能

### 💹 市場報價頁面

#### 報價連線
- **初始化報價**: 報價物件初始化
- **連線/離線**: 報價伺服器連接管理

#### 股票報價
- **訂閱功能**: 依市場別(上市/上櫃/興櫃)訂閱股票報價
- **取消訂閱**: 取消特定股票報價訂閱

#### K線查詢
- **多種K線**: 支援分K/日K/週K/月K查詢
- **歷史資料**: 查詢指定筆數的K線資料

### 🔔 系統訊息區域

#### 方法回傳訊息
- 顯示API方法執行結果
- 回傳代碼及訊息說明

#### 事件回報訊息
- 即時事件通知
- 帳號資訊回報
- 連線狀態更新
- 報價資料推送

## 💡 使用流程

### 1. 程式啟動
```bash
python CapitalIntegratedTester.py
```

### 2. 設定連線環境
- 選擇適當的連線環境(測試/正式)
- 輸入登入帳密

### 3. 登入系統
- 點擊「🔑 登入」按鈕
- 等待帳號資訊回傳

### 4. 選擇交易帳號
- 從下拉選單選擇使用者ID
- 選擇對應的交易帳號

### 5. 初始化連線
- 點擊「🔗 Proxy連線」建立下單連線
- 點擊「📡 連線報價」連接報價服務

### 6. 開始交易
- 切換到相應的交易頁面
- 填寫委託資訊並送出

## ⚠️ 注意事項

### 登入相關
- 請確保已安裝群益證券COM元件
- 測試環境需使用測試帳號
- AP身分需要憑證設定

### 交易相關
- 下單前請確認已完成Proxy連線
- 注意市場開盤時間限制
- 確認帳戶權限和額度

### 報價相關
- 報價資料需要市場授權
- 部分商品需要額外申請權限
- 連線異常時請重新連線

## 🔧 故障排除

### COM元件相關
```
錯誤: COM元件初始化失敗
解決: 重新安裝SKCOM.dll元件
```

### 登入問題
```
錯誤: 登入失敗
解決: 檢查帳密、網路連線、環境設定
```

### 下單問題
```
錯誤: 下單失敗
解決: 確認Proxy連線、帳戶權限、市場時段
```

### 報價問題
```
錯誤: 報價無資料
解決: 檢查報價連線、商品權限、市場開盤狀態
```

## 📞 技術支援

如有技術問題，請參考：
1. 群益證券API官方文件
2. 程式執行時的錯誤訊息
3. LOG檔案內容分析

## 📜 版本歷史

### v2.13.55 (目前版本)
- 整合所有V2模組功能
- 優化使用者介面設計
- 新增表情符號增強視覺效果
- 完善錯誤處理和訊息提示
- 支援完整交易流程

## 📄 授權聲明

此工具僅供學習和測試使用，請遵循群益證券API使用條款。