# 群益證券 API 整合測試工具

## 概述
這是一個整合了群益證券 API 所有功能的測試工具，類似官方的 SKCOMTester.exe，但使用 Python 開發，提供更好的可擴展性和自定義能力。

## 功能特色

### 🔐 登入管理
- 支援多環境登入（正式、測試、SGX）
- 雙因子驗證（AP/APH 身分）
- 代理伺服器連線管理
- 帳戶資訊自動獲取

### 📈 多市場下單交易
- **台股下單**: 現股、融資融券、無券賣出
- **期貨下單**: 台指期貨、複式單交易
- **海外股票**: 美股、港股等國際市場
- **海外期貨**: 國際期貨商品交易
- 支援同步/非同步下單方式

### 📊 即時報價訂閱
- 台股即時報價與逐筆資料
- 海外股票市場報價
- 海外選擇權報價
- 市場統計資料即時更新
- 技術指標計算

### 📨 交易回報監控
- 多市場回報分流顯示
- 委託與成交回報查詢
- Solace 高效能回報連線
- 智慧單執行狀態追蹤

### 🔍 查詢功能
- 委託回報查詢（全部/有效/已成交等）
- 成交回報查詢
- 即時庫存查詢
- 集保庫存查詢
- 資券配額查詢
- 損益查詢

## 系統需求

### 必要條件
- Windows 作業系統
- Python 3.6 或更高版本
- 已安裝群益證券 COM 元件

### Python 套件
```bash
pip install comtypes
```

### 群益證券 COM 元件安裝
1. 以系統管理員身分開啟命令提示字元
2. 執行安裝程式：
   ```cmd
   # 64位元系統
   cd "元件\x64"
   install.bat
   
   # 32位元系統  
   cd "元件\x86"
   install.bat
   ```

## 使用方法

### 1. 啟動程式
```bash
cd PythonIntegratedTester
python CapitalIntegratedTester.py
```

### 2. 登入流程
1. 選擇連線環境（正式/測試）
2. 輸入使用者帳號和密碼
3. 如果是 AP/APH 身分，勾選對應選項並輸入憑證ID
4. 點擊「登入」按鈕
5. 登入成功後選擇使用者和交易帳號
6. 初始化代理伺服器連線

### 3. 下單操作
1. 切換到「下單」分頁
2. 選擇對應的市場分頁（台股/期貨/海外股票/海外期貨）
3. 填入委託資料（代號、價格、數量等）
4. 點擊「送出委託」

### 4. 報價訂閱
1. 切換到「報價」分頁
2. 輸入要訂閱的股票代號
3. 點擊「訂閱報價」
4. 即時報價會顯示在下方表格中

### 5. 回報監控
1. 切換到「回報」分頁
2. 點擊「連線回報」建立回報連線
3. 各市場回報會自動分流到對應分頁顯示

## 介面說明

### 主視窗結構
```
選單列: 檔案/工具/說明
工具列: API版本/連線狀態
主分頁: 登入/下單/報價/回報
狀態區: 方法訊息/事件訊息
```

### 連線狀態指示燈
- **紅色**: 未連線
- **橙色**: 登入中
- **綠色**: 連線正常

### 訊息區域
- **方法訊息**: 顯示 API 方法呼叫結果
- **事件訊息**: 顯示即時事件通知和回報

## 設定檔說明

### Config.py
包含所有下拉選單的選項設定：
- 連線環境設定
- 各市場下單參數
- 報價訂閱類型  
- 查詢條件設定

可根據需要修改設定值以符合使用需求。

## 開發架構

### 主要類別
- `CapitalIntegratedTester`: 主應用程式類別
- `SKReplyLibEvent`: 回報事件處理
- `SKCenterLibEvent`: 中心事件處理  
- `SKOrderLibEvent`: 下單事件處理
- `SKQuoteLibEvent`: 報價事件處理

### COM 元件
- `m_pSKCenter`: 登入與連線管理
- `m_pSKOrder`: 下單與查詢
- `m_pSKQuote`: 台股報價
- `m_pSKOSQuote`: 海外股票報價
- `m_pSKOOQuote`: 海外選擇權報價
- `m_pSKReply`: 回報處理

## 注意事項

### 安全性
- 請確保在安全的環境中使用
- 不要在程式中儲存實際的帳號密碼
- 測試時建議使用測試環境

### 效能
- 大量報價訂閱可能影響效能
- 建議適當控制訂閱的商品數量
- 定期清理回報訊息避免記憶體累積

### 錯誤處理
- 所有 API 呼叫都有錯誤處理機制
- 錯誤訊息會顯示在方法訊息區
- 連線異常時會自動重連

## 常見問題

### Q: 程式無法啟動，出現 COM 元件錯誤？
A: 請確認已正確安裝群益證券 COM 元件，並且以系統管理員身分執行安裝程式。

### Q: 登入失敗？
A: 請檢查：
1. 帳號密碼是否正確
2. 連線環境是否選擇正確
3. 網路連線是否正常
4. 是否需要雙因子驗證

### Q: 無法收到報價資料？
A: 請確認：
1. 已成功登入
2. 代理伺服器連線正常
3. 股票代號輸入正確
4. 已訂閱該商品報價

### Q: 下單失敗？
A: 請檢查：
1. 帳號是否有下單權限
2. 委託資料是否完整正確
3. 資金是否足夠
4. 市場是否開市

## 技術支援

本工具基於群益證券 API v2.13.55 開發，如有問題請參考：
1. 群益證券官方 API 文件
2. 原始 PythonExampleV2 範例程式
3. 程式內建的錯誤訊息提示

## 版本資訊

**v1.0** (2025-09-13)
- 整合登入、下單、報價、回報功能
- 支援多市場交易
- 完整的事件處理機制
- 直觀的 GUI 介面設計

---
*此工具僅供學習和測試使用，實際交易請使用官方認證的交易軟體。*